<!DOCTYPE html>
<head>
    <title>
        Task Mongo Example
    </title>
    <link rel="stylesheet" href="/static/stylesheets/styles.css" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link href="https://use.fontawesome.com/release/v5.8.2/css/all.css" rel="stylesheet" /> -->
    <script>
        function done(taskTag){
            const _id = taskTag.getAttribute("data-taskId");
            fetch('/done', {
                method: 'PUT',
                body: JSON.stringify({ id: `${_id}`}),
                headers: {
                    "Content-Type": "application/json",
                }
            })
            .catch((error) => {
                console.error('Error:', error);
            });

        }
        function deleteItem(taskTag){
            const _id = taskTag.getAttribute("data-taskId");
            fetch(`/delete/${_id}`, {    // localhost/t89u0dh9eh7er <- ID
                method: 'DELETE',
                headers: {
                    "Content-Type": "application/json",
                }
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }
    
        //write the API call
        </script>
    </head>
    <body>
        <div class="container">
        <h2>
        
            <%= comicData.safe_title %>
        </h2>
        <img src="<%= comicData.img %>" alt="<% comicData.alt %>" width="500" height="500"/>
        </div>

        
        <div class="task-container">
        
        
            <h2>
                To-Do Items
            </h2>
            <div class="task">
                <form action="/create" method="POST" class="task-header">
                    <input type="text" name="content" />
                    <button type="submit" >
                        <i class="fa fa-plus"></i>
                    </button>
                </form>
                <ul class="task-list" >
                    <% taskList.forEach(function(task){ %>
                        <li class="task-list-item">
                            <% if(task.done){ %>
                                <div class="task-list-item-name strike-through">
                                    <%= task.task %>
                                </div>
                            <% } else { %>
                                <div class="task-list-item-name">
                                    <%= task.task %>
                                </div>
                            <% } %>
                        
                            <button data-taskId="<%= task._id %>" class="remove" onClick="done(this)">
                                <i class="fa fa-pencil"></i>
                            </button>
                            <button data-taskId="<%= task._id %>" class="edit" onClick="deleteItem(this)">
                                <i class="fa fa-trash"></i>
                            </button>
                        
                        </li>
                    <% }) %>
                </ul>
            
        </div>
    </div>
</body>